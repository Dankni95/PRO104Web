<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/index.css">

    <title>Gyldene Pizza</title>
    <!--Font awesome-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"
        integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
    <!--Google font-->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.2/css/bulma.min.css">

</head>

<body>

    <nav class="navigation">
        <div class="logo">
            <img class="logo-image" src="/images/Logo.svg" alt="A chef logo">
        </div>
        <ul class="nav-links-wrapper">
            <li class="nav-links active">
                <i class="far fa-bell"></i>
                <a class="nav-link" href="/index.html">Forside</a>
            </li>

            <li class="nav-links">
                <i class="fas fa-wallet"></i>
                <a class="nav-link" href="/salg.html">Salg</a>
            </li>

            <li class="nav-links">
                <i class="far fa-map"></i>
                <a class="nav-link" href="/meny.html">Meny</a>
            </li>

            <li class="nav-links">
                <i class="fas fa-users"></i>
                <a class="nav-link" href="/ansatte.html">Ansatte</a>
            </li>

            <li class="nav-links">
                <i class="fas fa-utensils"></i>
                <a class="nav-link" href="/restauranter.html">Restauranter</a>
            </li>
        </ul>

        <div class="seperator"></div>

        <div class="nav-logout-div">
            <button class="nav-logout-button">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </button>
        </div>
    </nav>

    <main class="main-div">

        <header class="topbar">
            <div class="topbar-left">
                <h1 class="topbar-title">Forside</h1>

                <div class="date">
                    <span id="day-id">Day</span>,
                    <span id="day-nr-id">00</span>.
                    <span id="month-id">Month</span>
                    <span id="year-id">Year</span>
                </div>
                <div class="separator"></div>
            </div>

            <div class="h2Header">
                <h2>Kunngjøringer</h2>
            </div>


            <div class="topbar-right">
                <div class="topbar-username">
                    <h4>Daniel Lysak</h4>
                    <i class="fas fa-chevron-down"></i>
                    <div class="topbar-line"></div>
                    <i class="fas fa-sign-in-alt"></i>
                </div>

            </div>
        </header>
    </main>

    <button href="#" class="addBtn" onclick="addTextArray()">

        <p><strong>+</strong> Legg til kunngjøring</p>
    </button>




    <!--Can't use input tag. Need to use textarea for wrapping the user input text in multi lines.-->
    <textarea name="text" id="text-field" class="txtInput" rows="14" cols="10" wrap="soft" maxlength="40"
        style="overflow:hidden; resize:none;"></textarea>


    <div>
        <select id="priority" class="dropdownMenuCSS">
            <option>Velg en prioritet</option>
        </select>
    </div>

    <div id="error-msg" class="errorOutput"></div>


    <main id="main" class="columnPosi">

        <div id="1" class="columns">
            <div class="column is-11
            is-offset-1 clumnColr is-multiline">
                <div class="has-text-right"><b id="delSymbol" class="fas fa-times fa-lg"></b></div>
                <p class="test">test</p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua.
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                consequat.
                Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
                laborum.
            </div>
        </div>

        <div id="2" class="columns">
            <div class="column is-11 is-offset-1 clumnColr is-multiline">
                <div class="has-text-right "><b id="delSymbol" class="fas fa-times fa-lg"></b></div>
                <p class="test">test</p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua.
                Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                consequat.
                Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
                laborum.
            </div>
        </div>





    </main>








    <script>
        var output = document.getElementsByClassName("columnPosi")[0];
        var priority = document.getElementById("priority");
        var textField = document.getElementById("text-field").style.fontSize = "12pt";
        var errorMsg = document.getElementById("error-msg");



        console.info(output.childNodes);

        var select = document.getElementById("priority"); /*Has to be named select, in order to function.*/
        var optionsArray =
            [
                {
                    importance: "Kritisk!",
                    colorTxt: "#FF6F5A"
                },
                {
                    importance: "Moderat",
                    colorTxt: "violet"
                },
                {
                    importance: "Uformelt",
                    colorTxt: "yellow"

                }

            ];
        for (var i = 0; i < optionsArray.length; i++) {
            var optMenu = optionsArray[i].importance;
            var elem = document.createElement("option");
            elem.textContent = optMenu;
            elem.value = optMenu;
            select.appendChild(elem);
        }


        var taskArray = []


        function addTextArray() {
            var textField = document.getElementById("text-field").value;
            var priority = document.getElementById("priority").value; //Important not to set toLowercase() when strings in array have capital first letters. Doesn't need this since it's not text imput.  

            for (var i = 0; i < optionsArray.length; i++) {
                if (priority === optionsArray[i].importance) {
                    taskArray.push(
                        {
                            optionChoice: optionsArray[i].importance, //adapting values from optionsArry
                            task: textField,
                            colorChoice: optionsArray[i].colorTxt //adapting values from optionsArry
                        }
                    );
                }

            }

            printFunc()
        }





        function printFunc() {
            var countTask = 0;
            errorMsg.innerHTML = "";
            //output.innerHTML = ""; //This would delete existing tasks, already existing
            document.getElementById("text-field").value;
            for (var i = 0; i < taskArray.length; i++) {
                if (textField.value != "") { //Make sure user needs to write something, not only choose importance, and still be able to create task. 
                    output.innerHTML += ` <div id=$ class="columns">
                <div class="column is-11 is-offset-1 clumnColr is-multiline">
                <div class="has-text-right "><b id="delSymbol" class="fas fa-times fa-lg"></b></div>
                <p style="color:${taskArray[i].colorChoice};">Viktighetsgrad: ${taskArray[i].optionChoice}</p>
                <p style="word-wrap:break-word;">is-four-fifths${taskArray[i].task}</p>
                  
                  </div>
                </div>`;
                    update();
                    countTask++;
                } /*else {
                    output.innerHTML = "Error";
                }*/
                taskArray = []; //Remove all items in array, to prevent duplicates if user adds another task.

            }
            if (countTask === 0) {
                errorMsg.innerHTML = `<p>Feil!</p> <erro>Du må både velge prioritet og skrive noe i kunngjøringen.</erro>`;
            }

        }

        function update() {
            removeButtonFunctionality();
        }


        let notification = document.getElementsByTagName("B");

        function removeButtonFunctionality() {

            for (var i = 0; i < notification.length; i++) {

                notification[i].addEventListener("mousedown", function (e) {
                    if (e.target.tagName === "B" && e.target.className === "fas fa-times fa-lg") {
                        e.target.offsetParent.remove()
                    }
                }, false)
            }
        }


        window.unload = update();



    </script>
</body>

</html>